@let venture = store.venture(); @let isLoading = store.isLoading();
<div class="dashboard-main-content">
  <div class="mb-6">
    <h5 class="text-2xl font-bold text-gray-900">Détails de la startup</h5>
  </div>
  @if (isLoading) {
    <div class="bg-white rounded-xl border border-gray-200 p-8 animate-pulse">
      <div class="flex items-center gap-4 mb-6">
        <div class="w-20 h-20 bg-gray-200 rounded-xl"></div>
        <div class="flex-1">
          <div class="h-6 bg-gray-200 rounded w-48 mb-2"></div>
          <div class="h-4 bg-gray-200 rounded w-32"></div>
        </div>
      </div>
      <div class="space-y-4">
        <div class="h-4 bg-gray-200 rounded w-full"></div>
        <div class="h-4 bg-gray-200 rounded w-3/4"></div>
      </div>
    </div>
  } @else if (venture) {
    <div class="bg-white rounded-xl border border-gray-200 shadow-sm mb-6 overflow-hidden">
      @if (venture.cover) {
        <div class="h-48 w-full overflow-hidden">
          <img [src]="venture | apiIMG: 'ventureCover'" [alt]="venture.name" class="w-full h-full object-cover" />
        </div>
      }
      <div class="p-6">
        <div class="flex flex-col md:flex-row items-start md:items-center gap-6">
          @if (venture.logo) {
            <img
              [src]="venture | apiIMG: 'venture'"
              [alt]="venture.name"
              class="w-24 h-24 rounded-xl object-cover border-4 border-white shadow-lg" />
          } @else {
            <div
              class="w-24 h-24 rounded-xl bg-primary-100 flex items-center justify-center text-primary-600 font-bold text-2xl border-4 border-white shadow-lg">
              {{ venture.name.charAt(0).toUpperCase() }}
            </div>
          }
          <div class="flex-1">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4">
              <div>
                <h3 class="text-3xl font-bold text-gray-900 mb-2">{{ venture.name }}</h3>
                @if (venture.description) {
                  <p class="text-gray-600 text-base leading-relaxed max-w-3xl">{{ venture.description }}</p>
                }
              </div>
              <app-ui-badge
                [label]="venture.is_published ? 'Publié' : 'Non publié'"
                [variant]="venture.is_published ? 'success' : 'warning'"
                [size]="'medium'" />
            </div>
            <div class="flex flex-wrap items-center gap-4 text-sm text-gray-600">
              @if (venture.sector) {
                <div class="flex items-center gap-2 px-3 py-1.5 bg-primary-50 rounded-lg border border-primary-200">
                  <i-lucide [name]="icons.Building2" class="size-4 text-primary-600" />
                  <span class="font-medium">{{ venture.sector }}</span>
                </div>
              }
              @if (venture.stage) {
                <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-50 rounded-lg border border-gray-200">
                  <span class="font-medium">{{ venture.stage }}</span>
                </div>
              }
              @if (venture.founded_at) {
                <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-50 rounded-lg border border-gray-200">
                  <i-lucide [name]="icons.Calendar" class="size-4 text-gray-600" />
                  <span class="font-medium">Fondé en {{ formatDate(venture.founded_at) }}</span>
                </div>
              }
              @if (venture.location) {
                <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-50 rounded-lg border border-gray-200">
                  <i-lucide [name]="icons.MapPin" class="size-4 text-gray-600" />
                  <span class="font-medium">{{ venture.location }}</span>
                </div>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
      <div class="lg:col-span-1">
        <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
              <i-lucide [name]="icons.Building2" class="w-5 h-5 text-primary-600" />
            </div>
            <h4 class="text-lg font-bold text-gray-900">Propriétaire</h4>
          </div>
          <div class="flex items-center gap-3 mb-4">
            <app-ui-avatar [shape]="'circle'" [image]="venture.owner | apiIMG: 'user'" [label]="venture.owner.name" />
            <div class="flex-1">
              <p class="font-semibold text-gray-900">{{ venture.owner.name }}</p>
              <p class="text-sm text-gray-500">{{ venture.owner.email }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="lg:col-span-2">
        <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
          <div class="flex items-center gap-3 mb-6">
            <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
              <i-lucide [name]="icons.Mail" class="w-5 h-5 text-primary-600" />
            </div>
            <h4 class="text-lg font-bold text-gray-900">Informations de contact</h4>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            @if (venture.email) {
              <a
                [href]="'mailto:' + venture.email"
                class="flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 group">
                <div
                  class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center group-hover:bg-primary-200 transition-colors">
                  <i-lucide [name]="icons.Mail" class="w-5 h-5 text-primary-600" />
                </div>
                <div class="flex-1">
                  <p class="text-xs text-gray-500 mb-0.5">Email</p>
                  <p class="text-sm font-medium text-gray-900">{{ venture.email }}</p>
                </div>
              </a>
            }
            @if (venture.phone_number) {
              <a
                [href]="'tel:' + venture.phone_number"
                class="flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 group">
                <div
                  class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center group-hover:bg-primary-200 transition-colors">
                  <i-lucide [name]="icons.Phone" class="w-5 h-5 text-primary-600" />
                </div>
                <div class="flex-1">
                  <p class="text-xs text-gray-500 mb-0.5">Téléphone</p>
                  <p class="text-sm font-medium text-gray-900">{{ venture.phone_number }}</p>
                </div>
              </a>
            }
            @if (venture.website) {
              <a
                [href]="venture.website"
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 group">
                <div
                  class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center group-hover:bg-primary-200 transition-colors">
                  <i-lucide [name]="icons.Globe" class="w-5 h-5 text-primary-600" />
                </div>
                <div class="flex-1">
                  <p class="text-xs text-gray-500 mb-0.5">Site web</p>
                  <p class="text-sm font-medium text-gray-900 truncate">{{ venture.website }}</p>
                </div>
                <i-lucide [name]="icons.ExternalLink" class="w-4 h-4 text-gray-400 group-hover:text-primary-600" />
              </a>
            }
            @if (venture.linkedin_url) {
              <a
                [href]="venture.linkedin_url"
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 group">
                <div
                  class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center group-hover:bg-primary-200 transition-colors">
                  <i-lucide [name]="icons.ExternalLink" class="w-5 h-5 text-primary-600" />
                </div>
                <div class="flex-1">
                  <p class="text-xs text-gray-500 mb-0.5">LinkedIn</p>
                  <p class="text-sm font-medium text-gray-900 truncate">Voir le profil</p>
                </div>
                <i-lucide [name]="icons.ExternalLink" class="w-4 h-4 text-gray-400 group-hover:text-primary-600" />
              </a>
            }
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
      @if (venture.problem_solved) {
        <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
          <h4 class="text-lg font-bold text-gray-900 mb-4">Problème résolu</h4>
          <p class="text-gray-600 leading-relaxed">{{ venture.problem_solved }}</p>
        </div>
      }
      @if (venture.target_market) {
        <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
          <h4 class="text-lg font-bold text-gray-900 mb-4">Marché cible</h4>
          <p class="text-gray-600 leading-relaxed">{{ venture.target_market }}</p>
        </div>
      }
    </div>
    @if (venture.gallery && venture.gallery.length > 0) {
      <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
            <i-lucide [name]="icons.ImageIcon" class="w-5 h-5 text-primary-600" />
          </div>
          <h4 class="text-lg font-bold text-gray-900">Galerie ({{ venture.gallery.length }})</h4>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
          @for (image of venture.gallery; track image.id) {
            <div
              class="relative group overflow-hidden rounded-lg border border-gray-200 hover:border-primary-300 transition-all duration-200">
              <div class="h-28 md:h-36 w-full overflow-hidden relative">
                <img
                  [ngSrc]="image | apiIMG: 'gallery'"
                  [alt]="venture.name"
                  class="object-cover group-hover:scale-105 transition-transform duration-200"
                  fill />
              </div>
            </div>
          }
        </div>
      </div>
    }
    @if (venture.products && venture.products.length > 0) {
      <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
            <i-lucide [name]="icons.Package" class="w-5 h-5 text-primary-600" />
          </div>
          <h4 class="text-lg font-bold text-gray-900">Produits ({{ venture.products.length }})</h4>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          @for (product of venture.products; track product.id) {
            <div
              class="bg-gray-50 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 hover:border-primary-200 overflow-hidden">
              @if (product.gallery && product.gallery.length > 0) {
                <div class="h-20 w-full overflow-hidden relative">
                  <img
                    [ngSrc]="product | apiIMG: 'product'"
                    [alt]="product.name"
                    class="w-full h-full object-cover hover:scale-105 transition-transform duration-200"
                    fill />
                </div>
              }
              <div class="p-5">
                <h5 class="text-lg font-bold text-gray-900 mb-2">{{ product.name }}</h5>
                @if (product.description) {
                  <p class="text-sm text-gray-600 mb-3 line-clamp-2">{{ product.description }}</p>
                }
                <div class="flex items-center justify-between">
                  @if (product.price) {
                    <span class="text-xl font-bold text-primary-600">{{ product.price }} €</span>
                  } @else {
                    <span class="text-sm text-gray-500">Prix non disponible</span>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    }

    <!-- Actions Footer -->
    <div class="mt-6 flex items-center justify-between bg-white rounded-xl border border-gray-200 shadow-sm p-4">
      <div class="text-sm text-gray-600">
        <span class="font-medium">Créé le:</span> {{ venture.created_at | date: 'longDate' }}
      </div>
      <button
        (click)="onTogglePublish()"
        class="ui-button ui-button-small"
        [class.ui-button-primary]="!venture.is_published"
        [class.ui-button-secondary]="venture.is_published">
        <i-lucide [name]="venture.is_published ? icons.ToggleRight : icons.ToggleLeft" class="size-4" />
        {{ venture.is_published ? 'Dépublier' : 'Publier' }}
      </button>
    </div>
  }
  <app-ui-confirm-dialog />
</div>
