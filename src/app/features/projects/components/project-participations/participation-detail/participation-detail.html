@let p = participation();
@let id = participationId();

<div class="space-y-4 px-4 py-5 sm:px-6">
  <div class="rounded-2xl border border-slate-200/80 bg-white p-4 shadow-sm">
    <h4 [id]="'detail-user-heading-' + id" class="mb-3 text-[11px] font-semibold uppercase tracking-[0.14em] text-slate-500">
      Participant
    </h4>

    <div class="flex flex-col gap-3 sm:flex-row sm:items-start">
      <app-ui-avatar [shape]="'circle'" [image]="p.user | apiIMG: 'user'" [label]="p.user.name" class="size-12 shrink-0" />

      <div class="min-w-0 flex-1 space-y-1.5">
        <p class="text-sm font-semibold text-slate-900">{{ p.user.name }}</p>

        @if (p.user.email) {
          <a [href]="'mailto:' + p.user.email" class="block break-all text-xs text-teal-700 transition-colors hover:text-teal-900">
            {{ p.user.email }}
          </a>
        }

        @if (p.user.phone_number) {
          <p class="text-xs text-slate-600">{{ p.user.phone_number }}</p>
        }

        @if (p.user.city || p.user.country) {
          <p class="text-xs text-slate-600">{{ p.user.city }}{{ p.user.city && p.user.country ? ', ' : '' }}{{ p.user.country }}</p>
        }

        @if (p.user.biography) {
          <p class="mt-2 line-clamp-3 text-xs leading-relaxed text-slate-600">{{ p.user.biography }}</p>
        }
      </div>
    </div>
  </div>

  @if (p.venture) {
    <div class="rounded-2xl border border-slate-200/80 bg-white p-4 shadow-sm">
      <h4 [id]="'detail-venture-heading-' + id" class="mb-3 text-[11px] font-semibold uppercase tracking-[0.14em] text-slate-500">
        Projet
      </h4>

      <div class="flex flex-col gap-3 sm:flex-row sm:items-start">
        <app-ui-avatar
          [shape]="'square'"
          [image]="p.venture | apiIMG: 'venture'"
          [label]="p.venture.name"
          class="size-12 shrink-0 rounded-xl" />

        <div class="min-w-0 flex-1 space-y-1.5">
          <p class="text-sm font-semibold text-slate-900">{{ p.venture.name }}</p>

          @if (p.venture.description) {
            <p class="line-clamp-3 text-xs leading-relaxed text-slate-600">{{ p.venture.description }}</p>
          }

          @if (p.venture.sector) {
            <p class="text-xs text-slate-600">{{ p.venture.sector }}</p>
          }

          @if (p.venture.stage) {
            <p class="text-xs text-slate-600">{{ p.venture.stage }}</p>
          }

          @if (p.venture.email) {
            <a
              [href]="'mailto:' + p.venture.email"
              class="block break-all text-xs text-teal-700 transition-colors hover:text-teal-900">
              {{ p.venture.email }}
            </a>
          }

          @if (p.venture.website) {
            <a
              [href]="p.venture.website"
              target="_blank"
              rel="noopener noreferrer"
              class="block truncate text-xs text-teal-700 transition-colors hover:text-teal-900">
              {{ p.venture.website }}
            </a>
          }
        </div>
      </div>
    </div>
  } @else {
    <div class="rounded-2xl border border-dashed border-slate-300 bg-stone-100/80 p-4">
      <h4 [id]="'detail-venture-heading-' + id" class="mb-2 text-[11px] font-semibold uppercase tracking-[0.14em] text-slate-500">
        Projet
      </h4>
      <p class="text-xs italic text-slate-500">Aucun projet associÃ©</p>
    </div>
  }

  @if (p.phases.length) {
    <div class="rounded-2xl border border-slate-200/80 bg-white p-4 shadow-sm">
      <h4 [id]="'detail-phases-heading-' + id" class="mb-3 text-[11px] font-semibold uppercase tracking-[0.14em] text-slate-500">
        Phases
      </h4>
      <div class="flex flex-wrap gap-2">
        @for (ph of p.phases; track ph.id) {
          <app-ui-badge [label]="ph.name" variant="info" />
        }
      </div>
    </div>
  }
</div>
